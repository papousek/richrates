<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j">

    <body>
        <ui:composition template="/templates/template.xhtml">

            <ui:define name="title">RichRates</ui:define>

            <ui:define name="head">
                <h:outputScript library="scripts" name="richrates.js"/>
                <h:outputStylesheet library="styles" name="calculator.css"/>
            </ui:define>

            <ui:define name="main">
                <div>
                    <div class="calculator"><a4j:outputPanel id="calculatorPanel">
                            <h:form id="calculator">
                                <h:panelGrid columns="4">
                                    <h:graphicImage id="firstCurrency"
                                                    library="flags"
                                                    name="#{calculatorBean.fromEuro ? 'EUR' : calculatorBean.selectedCurrency}_192.png"
                                                    alt="#{calculatorBean.fromEuro ? 'Euro' : ratesBean.currencyNames[calculatorBean.selectedCurrency]}"
                                                    title="#{calculatorBean.fromEuro ? 'Euro' : ratesBean.currencyNames[calculatorBean.selectedCurrency]}" />

                                    <a4j:commandButton id="swap" type="image" image="/resources/images/swap-gray.png" style="width: 32px;"
                                                       title="Swap currencies" onmouseover="this.style.cursor='pointer'" 
                                                       render="calculatorPanel" action="#{calculatorBean.swap}"/>

                                    <h:graphicImage id="secondCurrency"
                                                    library="flags"
                                                    name="#{calculatorBean.fromEuro ? calculatorBean.selectedCurrency : 'EUR'}_192.png"
                                                    alt="#{calculatorBean.fromEuro ? ratesBean.currencyNames[calculatorBean.selectedCurrency] : 'Euro'}"
                                                    title="#{calculatorBean.fromEuro ? ratesBean.currencyNames[calculatorBean.selectedCurrency] : 'Euro'}" />
                                </h:panelGrid>

                                <rich:messages id="validationMsgs" showDetail="false" showSummary="true"/>
                                <h:panelGrid id="form" columns="3">
                                    <h:outputLabel value="Date:" for="date" />
                                    <rich:calendar id="date" value="#{calculatorBean.selectedDate}" required="true"
                                                   styleClass="calendar" boundaryDatesMode="select" dayDisableFunction="disablementFunction"
                                                   dayClassFunction="disabledClassesProv" validator="#{ratesBean.validateDate}" defaultLabel="Select a date"
                                                   timeZone="#{ratesBean.timeZone}"/>
                                    <rich:message id="dateMsg" for="date" showDetail="false" showSummary="false" style="width: 16px; height: 16px;"/>


                                    <h:outputLabel value="Amount:" for="amount" />
                                    <h:inputText id="amount" value="#{calculatorBean.amount}" required="true" label="Amount">
                                        <rich:validator />
                                    </h:inputText>
                                    <rich:message id="amountMsg" for="amount" showDetail="false" showSummary="false"/>

                                    <!--                                    <rich:spacer id="space" height="30px" />-->

                                    <a4j:commandButton id="calculateButton" value="Calculate" type="submit"
                                                       action="#{calculatorBean.calculate}" render="calculatorPanel" />
                                </h:panelGrid>

                                <div class="result"><h:panelGroup rendered="#{calculatorBean.amount > 0}">
                                        <h:outputText value="#{calculatorBean.amount}">
                                            <f:convertNumber minFractionDigits="3" maxFractionDigits="3" />
                                        </h:outputText>
                                        <h:outputText value=" #{calculatorBean.fromEuro ? 'EUR' : calculatorBean.selectedCurrency} = " />
                                        <h:outputText value="#{calculatorBean.result}">
                                            <f:convertNumber minFractionDigits="3" maxFractionDigits="3" />
                                        </h:outputText>
                                        <h:outputText value=" #{calculatorBean.fromEuro ? calculatorBean.selectedCurrency : 'EUR'}" />
                                    </h:panelGroup></div>
                            </h:form>
                        </a4j:outputPanel></div>

                    <div class="flags">
                        <h:form id="flagsForm" prependId="false">
                            <rich:dataGrid value="#{ratesBean.codes}" id="flags" var="code" columns="3">

                                <a4j:commandButton id="flag" image="/resources/flags/#{code}_64.png" action="#{calculatorBean.selectCurrency}"
                                                   render="calculatorPanel" title="#{ratesBean.currencyNames[code]}"
                                                   onmouseover="this.style.cursor='pointer'">
                                    <a4j:param assignTo="#{calculatorBean.selectedCurrency}" name="currency" value="#{code}"/>
                                </a4j:commandButton>

                            </rich:dataGrid>
                        </h:form>
                    </div>
                </div>
            </ui:define>
        </ui:composition>
    </body>
</html>
